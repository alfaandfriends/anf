import{y as f,x as s,u as n,Q as o,F as k,bf as g,t as u,W as a,v as $,z as d,C as T,J as N,K as _,q as C,Y as R,A as B,I}from"./@vue-3ecac556.js";import{B as U}from"./Authenticated-da5fe39a.js";import{H as O,L as D}from"./@inertiajs-72b4b122.js";import P from"./StudentInformation-f4e38f93.js";import{h as E}from"./moment-a9aaa855.js";import{a as j}from"./axios-3a665b0f.js";import L from"./FeedbackSummary-d528812a.js";import{e as M}from"./vue-debounce-ed417ae1.js";import{_ as A}from"./Card-aacd8da5.js";import{_ as J,a as z,b as V,c as y,d as W,e as h}from"./TableRow-91ce9765.js";import{_ as H}from"./DialogModal-691e4667.js";import{_ as F}from"./Collapsible-5a7db4b8.js";import{e as G,f as K,g as Y}from"./app-6cbce3f4.js";import{W as q}from"./lucide-vue-next-214c8f72.js";import"./ApplicationLogo-fd2f7b3a.js";import"./radix-vue-0dbe0706.js";import"./@floating-ui-24f01f9d.js";import"./@internationalized-2f03b566.js";import"./class-variance-authority-ff2c9236.js";import"./clsx-0839fdbe.js";import"./@radix-icons-3edfb593.js";import"./DialogDescription-c92c752a.js";import"./lodash.isequal-1ba6c16d.js";import"./vue-7c584690.js";import"./lodash.clonedeep-8ef52793.js";import"./qs-dba4bf9b.js";import"./side-channel-218a49f6.js";import"./get-intrinsic-88feedc6.js";import"./es-errors-82fd953f.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-1353c55e.js";import"./function-bind-61637ca6.js";import"./hasown-bc561cf0.js";import"./call-bind-9ec8ebd8.js";import"./set-function-length-ecd19468.js";import"./define-data-property-d38573ea.js";import"./es-define-property-cfa03815.js";import"./gopd-4c4454f6.js";import"./has-property-descriptors-68e2873e.js";import"./object-inspect-b36cc063.js";import"./deepmerge-89e33937.js";import"./nprogress-34327965.js";import"./pusher-js-b1694987.js";import"./@vueform-8c23d62f.js";import"./cropperjs-274ed722.js";import"./laravel-vite-plugin-d10ca5e8.js";import"./v-calendar-4075303e.js";import"./tailwind-merge-05141ada.js";import"./@vueuse-25519c21.js";import"./@vuepic-e1682e24.js";import"./@babel-1b80a44a.js";const Q={class:"p-1 grid grid-cols-1 gap-4"},X={class:""},Z={class:""},x={class:"mb-3"},ee={class:""},te={class:""},se={class:""},oe={class:"mb-3"},re={key:0,class:"px-4 py-2 bg-slate-100 rounded-lg"},ie={class:"flex items-center space-x-2"},ae={class:"p-1"},ne={class:""},le={class:"flex justify-between items-center mb-2"},de={class:"flex items-center"},pe={key:0,class:"text-xs"},me={class:"flex flex-col gap-2"},ue={class:"relative"},_e={class:""},ce={components:{Head:O,Link:D},data(){return{open_prompt:!1,selected_text:"",additional_inputs:"",generating:{comments:!1},improving_comment:!1,show_progress_report:!1,open_objectives:[],searching:!1,progress_report_list:{},list:{teachers:[]},options:{lessons:[],topics:[],objectives:[],activities_procedures:[]},loading:{topics:!1,objectives:!1,lessons:!1,teachers:!1},search:{lesson_id:"",topic_id:"",objective_id:""},form:{teacher_user_id:"",revision:!1,date:"",report_data:[],comments:"",attendance_status:""}}},methods:{viewProgressReport(i){this.clearSearch(),this.form.report_id=this.$page.props.progress_reports[i].id,this.form.teacher_user_id=this.$page.props.progress_reports[i].teacher_user_id,this.form.teacher_name=this.$page.props.progress_reports[i].display_name,this.form.date=this.$page.props.progress_reports[i].date,this.form.report_data=JSON.parse(this.$page.props.progress_reports[i].report_data)?JSON.parse(this.$page.props.progress_reports[i].report_data):[],this.form.attendance_status=this.$page.props.progress_reports[i].attendance_status,this.form.comments=this.$page.props.progress_reports[i].comments,this.form.revision=!!this.$page.props.progress_reports[i].revision,this.show_progress_report=!0},updateProgressReport(){!this.form.date||this.form.attendance_status==3||this.form.attendance_status==1&&this.form.report_data.length<1||this.form.attendance_status==1&&!this.form.teacher_user_id||this.$inertia.post(route("progress_report.store"),this.form,{preserveScroll:!0,preserveState:!1})},findTeachers:M(function(i){i&&(this.loading.teachers=!0,j.get(route("teachers.find"),{params:{keyword:i}}).then(t=>{this.list.teachers=t.data,this.loading.teachers=!1}))},1e3),getTopics(i){this.loading.topics=!0,this.options.topics=[],this.options.objectives=[],this.search.topic_id="",this.search.objective_id="",j.get(route("progress_report.get_coding_topics",i)).then(t=>{this.options.topics=t.data,this.loading.topics=!1})},getObjectives(i){this.loading.objectives=!0,this.options.objectives=[],this.search.objective_id="",j.get(route("progress_report.get_coding_objectives",i)).then(t=>{this.options.objectives=t.data,this.loading.objectives=!1})},addItem(){this.searching||this.search.lesson_id&&this.search.topic_id&&this.search.objective_id&&(this.form.report_data.some(t=>t.objective_id===this.search.objective_id)?alert("Item Exists!"):(this.searching=!0,j.get(route("progress_report.get_coding_activities_procedures",this.search.objective_id)).then(t=>{var m,S,b;const e={lesson_id:this.search.lesson_id,lesson_name:(m=this.$page.props.coding_lessons.find(r=>r.id===this.search.lesson_id))==null?void 0:m.name,topic_id:this.search.topic_id,topic_name:(S=this.options.topics.find(r=>r.id===this.search.topic_id))==null?void 0:S.name,objective_id:this.search.objective_id,objective_name:(b=this.options.objectives.find(r=>r.id===this.search.objective_id))==null?void 0:b.name,activities_procedures:[]},p=this.form.report_data.length;this.form.report_data.push(e);const l=p,v=this.form.report_data[l];t.data.forEach(r=>{v.activities_procedures.push({id:r.id,name:r.name,achieved:!1})}),this.searching=!1})))},deleteItem(i){this.form.report_data.splice(i,1)},clearSearch(){this.form.teacher_user_id="",this.search.objective_id="",this.search.topic_id="",this.search.lesson_id=""},async generateComment(){if(this.generating.comments)return;this.generating.comments=!0,this.open_prompt=!1,this.form.comments="";const i=await fetch("/api/ai/comment-generator",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_prompt:`
                Report Content:
                ${JSON.stringify(this.form.report_data)}

                User Additional Information:
                ${this.additional_inputs}`})});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const t=i.body.getReader(),e=new TextDecoder;for(;;){const{done:p,value:l}=await t.read();if(p)break;this.form.comments+=e.decode(l,{stream:!0})}this.additional_inputs="",this.generating.comments=!1},async improveWriting(){if(!this.improving_comment){if(this.improving_comment=!0,this.selected_text){const i=JSON.parse(JSON.stringify(this.selected_text)),t=await fetch("/api/ai/comment-improve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_prompt:`
                Report Content:
                ${JSON.stringify(this.form.report_data)}

                Actual Comment:
                ${this.form.comments}

                Selected phrase:
                ${this.selected_text}`})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=t.body.getReader(),p=new TextDecoder;let l="";for(;;){const{done:v,value:m}=await e.read();if(v)break;l+=p.decode(m,{stream:!0})}this.form.comments=this.form.comments.replaceAll(i,l)}this.improving_comment=!1}},handleSelection(){const i=window.getSelection();i.rangeCount>0&&i.toString().trim().length>0?this.selected_text=i.toString():this.selected_text=""},clearSelection(i){i&&i.relatedTarget&&i.relatedTarget.matches(".improve-btn")||(window.getSelection().removeAllRanges(),this.selected_text="")}}},ut=Object.assign(ce,{__name:"CodingRobotics",setup(i){return(t,e)=>{const p=g("Button"),l=g("Label"),v=g("Datepicker"),m=g("ComboBox"),S=g("Checkbox"),b=g("Textarea");return u(),f(k,null,[s(n(O),{title:"Progress Report"}),s(U,null,{header:o(()=>e[16]||(e[16]=[])),default:o(()=>[s(P),s(A,null,{title:o(()=>e[17]||(e[17]=[a("Progress Reports")])),content:o(()=>[s(n(J),null,{default:o(()=>[s(n(z),{class:"bg-gray-100"},{default:o(()=>[s(n(V),null,{default:o(()=>[s(n(y),null,{default:o(()=>e[18]||(e[18]=[a("#")])),_:1,__:[18]}),s(n(y),null,{default:o(()=>e[19]||(e[19]=[a("Date")])),_:1,__:[19]}),s(n(y),null,{default:o(()=>e[20]||(e[20]=[a("Teacher's Name")])),_:1,__:[20]}),s(n(y),{class:"text-center"},{default:o(()=>e[21]||(e[21]=[a("Status")])),_:1,__:[21]}),s(n(y),{class:"text-center"},{default:o(()=>e[22]||(e[22]=[a("Action")])),_:1,__:[22]})]),_:1})]),_:1}),s(n(W),null,{default:o(()=>[t.$page.props.progress_reports.length?T("",!0):(u(),$(n(V),{key:0},{default:o(()=>[s(n(h),{class:"text-center",colspan:"10"},{default:o(()=>e[23]||(e[23]=[d("div",{class:"p-3"},"No Record Found",-1)])),_:1,__:[23]})]),_:1})),(u(!0),f(k,null,N(t.$page.props.progress_reports,(r,c)=>(u(),$(n(V),null,{default:o(()=>[s(n(h),null,{default:o(()=>[a(_(c+1),1)]),_:2},1024),s(n(h),null,{default:o(()=>[a(_(n(E)(r.date).format("DD/MM/Y")),1)]),_:2},1024),s(n(h),null,{default:o(()=>[a(_(r.display_name),1)]),_:2},1024),s(n(h),{class:"text-center"},{default:o(()=>[d("span",{class:C(["inline-flex items-center justify-center px-2 py-1 text-xs rounded",[{"bg-green-200 text-green-600":r.attendance_status==1},{"bg-red-200 text-red-600":r.attendance_status==2},{"bg-gray-200 text-gray-600":r.attendance_status==3},{"bg-blue-200 text-blue-600":r.attendance_status==4}]])},_(r.attendance_status_name),3)]),_:2},1024),s(n(h),{class:"text-center"},{default:o(()=>[s(p,{variant:"outline",onClick:w=>t.viewProgressReport(c)},{default:o(()=>e[24]||(e[24]=[a("Edit")])),_:2,__:[24]},1032,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1}),s(L,{report_details:t.$page.props.report_details},null,8,["report_details"]),s(H,{open:t.show_progress_report,"onUpdate:open":e[15]||(e[15]=r=>t.show_progress_report=r)},{title:o(()=>e[25]||(e[25]=[a("Edit Progress Report")])),content:o(()=>[d("div",Q,[d("div",X,[s(l,{id:"date"},{default:o(()=>e[26]||(e[26]=[a("Date"),d("span",{class:"text-red-500"},"*",-1)])),_:1,__:[26]}),s(v,{modelValue:t.form.date,"onUpdate:modelValue":e[0]||(e[0]=r=>t.form.date=r),mode:"date",format:"dd/MM/Y",error:!t.form.date,teleport:"#date",teleportCenter:!0},null,8,["modelValue","error"])]),d("div",Z,[s(l,null,{default:o(()=>e[27]||(e[27]=[a("Teacher's Name"),d("span",{class:"text-red-500"},"*",-1)])),_:1,__:[27]}),s(m,{items:t.list.teachers,"label-property":"display_name","value-property":"ID",error:t.form.attendance_status==1&&!t.form.teacher_user_id,modelValue:t.form.teacher_user_id,"onUpdate:modelValue":e[1]||(e[1]=r=>t.form.teacher_user_id=r),"select-placeholder":t.form.teacher_name,"search-placeholder":"Search teacher...",onSearch:t.findTeachers,loading:t.loading.teachers},null,8,["items","error","modelValue","select-placeholder","onSearch","loading"])]),d("div",x,[s(l,{class:"flex items-center space-x-2"},{default:o(()=>[s(S,{value:t.form.revision,checked:t.form.revision,onClick:e[2]||(e[2]=r=>t.form.revision=!t.form.revision)},null,8,["value","checked"]),e[28]||(e[28]=d("span",{class:"cursor-pointer"},"Revision",-1))]),_:1,__:[28]})]),d("div",ee,[s(l,null,{default:o(()=>e[29]||(e[29]=[a("Lesson")])),_:1,__:[29]}),s(m,{items:t.$page.props.coding_lessons,"label-property":"name","value-property":"id",modelValue:t.search.lesson_id,"onUpdate:modelValue":e[3]||(e[3]=r=>t.search.lesson_id=r),"select-placeholder":"Select Lesson","search-placeholder":"Search lesson...",onSelect:e[4]||(e[4]=r=>t.getTopics(t.search.lesson_id))},null,8,["items","modelValue"])]),d("div",te,[s(l,null,{default:o(()=>e[30]||(e[30]=[a("Topic")])),_:1,__:[30]}),s(m,{items:t.options.topics,"label-property":"name","value-property":"id",modelValue:t.search.topic_id,"onUpdate:modelValue":e[5]||(e[5]=r=>t.search.topic_id=r),"select-placeholder":"Select Topic","search-placeholder":"Search topic...",onSelect:e[6]||(e[6]=r=>t.getObjectives(t.search.topic_id)),loading:t.loading.topics},null,8,["items","modelValue","loading"])]),d("div",se,[s(l,null,{default:o(()=>e[31]||(e[31]=[a("Learning Objective")])),_:1,__:[31]}),s(m,{items:t.options.objectives,"label-property":"name","value-property":"id",modelValue:t.search.objective_id,"onUpdate:modelValue":e[7]||(e[7]=r=>t.search.objective_id=r),"select-placeholder":"Select Objective","search-placeholder":"Search objective...",onSelect:e[8]||(e[8]=r=>t.addItem()),loading:t.loading.objectives},null,8,["items","modelValue","loading"])]),d("div",oe,[s(l,null,{default:o(()=>e[32]||(e[32]=[a("Objectives")])),_:1,__:[32]}),t.form.report_data.length?(u(!0),f(k,{key:1},N(t.form.report_data,(r,c)=>(u(),$(F,{class:"bg-white",modelValue:t.open_objectives[c],"onUpdate:modelValue":w=>t.open_objectives[c]=w},{trigger:o(()=>[d("div",ie,[s(l,{class:"whitespace-pre-line"},{default:o(()=>[a(_(r.lesson_name)+" : "+_(r.topic_name),1)]),_:2},1024),s(l,{class:"text-red-600 cursor-pointer",onClick:w=>t.deleteItem(c)},{default:o(()=>e[34]||(e[34]=[a("Delete")])),_:2,__:[34]},1032,["onClick"])])]),content:o(()=>[d("div",ae,[s(l,null,{default:o(()=>[a(_(r.objective_name),1)]),_:2},1024)])]),_:2},1032,["modelValue","onUpdate:modelValue"]))),256)):(u(),f("div",re,[s(l,null,{default:o(()=>e[33]||(e[33]=[a("No objectives found.")])),_:1,__:[33]})])),!t.form.report_data.length&&t.form.attendance_status==1?(u(),$(l,{key:2,class:"text-xs text-red-500 font-semibold"},{default:o(()=>e[35]||(e[35]=[a("At least one (1) objective is required.")])),_:1,__:[35]})):T("",!0)]),d("div",ne,[d("div",le,[s(l,null,{default:o(()=>e[36]||(e[36]=[a("Comments")])),_:1,__:[36]}),s(n(G),{open:t.open_prompt,"onUpdate:open":e[11]||(e[11]=r=>t.open_prompt=r)},{default:o(()=>[s(n(K),null,{default:o(()=>[s(p,{size:"xs",variant:"outline",class:"border-0 bg-gradient-to-r from-purple-300 to-indigo-300 hover:bg-gradient-to-r hover:from-indigo-300 hover:to-purple-300"},{default:o(()=>[d("div",de,[s(n(q),{class:C(["w-3.5 h-3.5 mr-1 mt-0.5",{"animate-pulse":t.generating.comments}])},null,8,["class"]),t.generating.comments?(u(),f("span",{key:1,class:C(["text-xs",{"animate-pulse":t.generating.comments}])},"Generating...",2)):(u(),f("span",pe,"Generate with AI"))])]),_:1})]),_:1}),s(n(Y),{align:"start",side:"left",class:"w-96 bg-gradient-to-r from-purple-200 to-indigo-200 bg-opacity-70 p-2"},{default:o(()=>[d("div",me,[s(b,{class:"bg-white placeholder:text-sm placeholder:text-zinc-400",rows:"4",type:"text",placeholder:`What would you like to add? 

Example: Teaching methods, activities, issues, in Malay/English and etc...`,modelValue:t.additional_inputs,"onUpdate:modelValue":e[9]||(e[9]=r=>t.additional_inputs=r)},null,8,["modelValue"]),s(p,{size:"xs",class:"",variant:"",onClick:e[10]||(e[10]=r=>t.additional_inputs?t.generateComment():"")},{default:o(()=>e[37]||(e[37]=[a("Prompt It")])),_:1,__:[37]})])]),_:1})]),_:1},8,["open"])]),d("div",ue,[s(b,{class:"mb-2",rows:"10",modelValue:t.form.comments,"onUpdate:modelValue":e[12]||(e[12]=r=>t.form.comments=r),modelModifiers:{lazy:!0},contenteditable:"true",onMouseup:t.handleSelection,onMousedown:t.clearSelection,onBlur:t.clearSelection,onKeyup:t.handleSelection},null,8,["modelValue","onMouseup","onMousedown","onBlur","onKeyup"]),s(R,{name:"fade-slide"},{default:o(()=>[B(s(p,{onBlur:t.clearSelection,onClick:t.improveWriting,size:"xs",variant:"outline",class:"improve-btn bg-gradient-to-r from-purple-200 to-blue-200 font-medium absolute text-xs bottom-3 left-1/2 transform -translate-x-1/2"},{default:o(()=>[a(_(t.improving_comment?"Generating...":"Improve Writing"),1)]),_:1},8,["onBlur","onClick"]),[[I,t.selected_text]])]),_:1})])]),d("div",_e,[s(l,null,{default:o(()=>e[38]||(e[38]=[a("Status")])),_:1,__:[38]}),s(m,{items:t.$page.props.attendance_status,"label-property":"name","value-property":"id",error:t.form.attendance_status==3,modelValue:t.form.attendance_status,"onUpdate:modelValue":e[13]||(e[13]=r=>t.form.attendance_status=r),"select-placeholder":"Select Status","search-placeholder":"Search status..."},null,8,["items","error","modelValue"])])])]),footer:o(()=>[s(p,{variant:"outline",onClick:e[14]||(e[14]=r=>t.show_progress_report=!1)},{default:o(()=>e[39]||(e[39]=[a("Cancel")])),_:1,__:[39]}),s(p,{onClick:t.updateProgressReport},{default:o(()=>e[40]||(e[40]=[a("Save")])),_:1,__:[40]},8,["onClick"])]),_:1},8,["open"])]),_:1})],64)}}});export{ut as default};
