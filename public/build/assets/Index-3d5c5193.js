import{y as a,x as d,u as c,Q as m,F as h,t as r,W as _,K as u,z as e,q as g,C as n,J as v,v as f,A as $,bH as C}from"./@vue-d42dd214.js";import{_ as L}from"./Authenticated-ec9e2ebe.js";import{H}from"./@inertiajs-7f289881.js";import{s as x}from"./simplebar-vue-9ef772f5.js";import D from"./Header-74581b3f.js";import{T as w}from"./TimeAgo-b39f7b9d.js";import{C as k,S as b,P as B,N as y}from"./vue3-carousel-7f0cea82.js";import{D as S}from"./luxon-8ddd27a0.js";import"./@heroicons-e6194902.js";import"./app-ece3933f.js";import"./axios-1779699b.js";import"./laravel-echo-96cacb8d.js";import"./pusher-js-6d7d8249.js";import"./@vueform-cd27a95b.js";import"./cropperjs-bffc402e.js";import"./laravel-vite-plugin-d10ca5e8.js";import"./vue-debounce-ed417ae1.js";import"./v-calendar-4b397a2a.js";import"./radix-vue-00e18109.js";import"./@floating-ui-61ac2ed2.js";import"./@internationalized-2f03b566.js";import"./clsx-1229b3e0.js";import"./tailwind-merge-3f7ff3b1.js";import"./@vueuse-7b89e231.js";import"./class-variance-authority-52f2569e.js";import"./@radix-icons-4975f794.js";import"./@vuepic-1824abb1.js";import"./@babel-1b80a44a.js";import"./lodash.isequal-23888b5c.js";import"./vue-671a4423.js";import"./lodash.clonedeep-15cd822c.js";import"./qs-78438f3a.js";import"./side-channel-52add6bf.js";import"./get-intrinsic-88feedc6.js";import"./es-errors-82fd953f.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-1353c55e.js";import"./function-bind-61637ca6.js";import"./hasown-bc561cf0.js";import"./call-bind-9ec8ebd8.js";import"./set-function-length-ecd19468.js";import"./define-data-property-d38573ea.js";import"./es-define-property-cfa03815.js";import"./gopd-4c4454f6.js";import"./has-property-descriptors-68e2873e.js";import"./object-inspect-1fdcb41b.js";import"./deepmerge-89e33937.js";import"./nprogress-b9cffc46.js";import"./@headlessui-a01ed24c.js";import"./simplebar-core-3f5973b9.js";import"./lodash-es-9b1d07da.js";import"./javascript-time-ago-55ed0321.js";import"./relative-time-format-ec7ee7be.js";import"./moment-a9aaa855.js";const M={class:"max-w-xl mx-auto border shadow bg-white rounded-lg px-4 mt-14"},z={class:"flex justify-evenly sm:justify-center space-x-8 md:space-x-10 pt-3 pb-4 font-medium"},A={class:"max-w-xl mx-auto mt-5"},T={key:0,class:"flex items-center space-y-3"},V={key:1,class:"flex justify-center mx-1 mt-10"},j={class:"mt-3 flex flex-col space-y-3 bg-white py-3 px-4 shadow-md rounded-xl text-sm"},N={class:"flex flex-row text-sm items-center"},P={class:"flex justify-between items-center flex-1 font-bold leading-tight select-none"},I={class:"flex flex-col"},E={class:"text-slate-900 md:text-md font-bold"},Z={class:"text-xs font-medium text-slate-500"},F={class:"flex items-center"},K={class:"text-sm text-slate-800"},U={class:"carousel__item h-full"},q=["src","onDblclick"],G={class:"flex items-center space-x-4"},J={key:0,class:""},O=["onClick"],Q=["onClick"],R={key:1,class:"space-y-2"},W={key:0,class:"flex-col w-full mx-auto bg-white shadow border border-gray-300 px-4 py-3 rounded-lg"},X={class:"divide-y space-y-2"},Y={class:"flex flex-row pt-1 md-10"},ee={class:"flex-col mt-1"},te={class:"flex items-center flex-1 font-bold leading-tight"},se={class:"text-xs font-normal text-gray-500 ml-2"},oe={class:"flex-1 text-sm font-medium leading-loose text-gray-600"},re=["onUpdate:modelValue"],ae=["onClick"],ie={key:3,class:"mt-3 max-w-xl py-3 px-4 border border-gray-200 rounded-xl shadow animate-pulse bg-white"},le={components:{simplebar:x,TimeAgo:w,Carousel:k,Slide:b,Pagination:B,Navigation:y},data(){return{show_comment:!1,loading:{stories:!1},comments:[]}},methods:{isLikedByParent(i){return this.$page.props.stories.data[i].likes.length?this.$page.props.stories.data[i].likes.some(t=>t.like_author_id===this.$page.props.auth.user.ID):!1},toggleLike(i,t){if(this.isLikedByParent(i)){const s=this.$page.props.stories.data[i].likes.findIndex(o=>o.like_author_id===this.$page.props.auth.user.ID);this.$page.props.stories.data[i].likes.splice(s,1)}else this.$page.props.stories.data[i].likes.push({like_author_id:this.$page.props.auth.user.ID});axios.post(route("parent.like_story"),{story_id:t,to_delete:!this.isLikedByParent(i)}).then(s=>{})},toggleComment(){this.show_comment=!this.show_comment},postComment(i,t){axios.post(route("parent.stories.comments.store"),{story_id:t,comment:this.comments[i]}).then(s=>{s.data&&(this.$page.props.stories.data[i].comments.unshift({comment:this.comments[i],comment_user_name:this.$page.props.auth.user.display_name,created_at:S.now().setZone("Asia/Kuala_Lumpur").toFormat("yyyy-MM-dd HH:mm:ss")}),this.comments[i]="")})},handleStoryScroll(){const i=document.documentElement.scrollTop||document.body.scrollTop,t=document.documentElement.scrollHeight||document.body.scrollHeight,s=document.documentElement.clientHeight||window.innerHeight;i+s>=t-100&&this.$page.props.stories.next_page_url&&(this.loading.stories||(this.loading.stories=!0,axios.get(route("parent.student_stories",[this.$page.props.session_data.current_active_child.student_id,this.$page.props.session_data.current_active_programme.id]),{params:{page:this.$page.props.stories.current_page+1}}).then(o=>{o.data.data.forEach(p=>{this.$page.props.stories.data.push(p)}),this.$page.props.stories.current_page=o.data.current_page,this.$page.props.stories.next_page_url=o.data.next_page_url,this.loading.stories=!1})))}}},mt=Object.assign(le,{__name:"Index",setup(i){return(t,s)=>(r(),a(h,null,[d(c(H),{title:"Home"}),d(D,null,{default:m(()=>[_(u(t.$page.props.current_active_programme.name),1)]),_:1}),d(L,{onScroll:t.handleStoryScroll},{default:m(()=>[e("div",M,[d(c(x),{"data-simplebar-auto-hide":"true"},{default:m(()=>[e("div",z,[e("div",{class:g(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",t.route().current("parent.stories")?"font-extrabold":""]),onClick:s[0]||(s[0]=o=>t.$inertia.get(t.route("parent.stories",t.$page.props.current_active_programme.encrypted_id)))},s[6]||(s[6]=[e("img",{src:"/images/parents/stories.png",class:"w-10 h-10",alt:""},null,-1),e("span",{class:"text-sm"},"Stories",-1)]),2),e("div",{class:g(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",t.route().current("parent.progress_reports")?"font-extrabold":""]),onClick:s[1]||(s[1]=o=>t.$inertia.get(t.route("parent.progress_reports")))},s[7]||(s[7]=[e("img",{src:"/images/parents/progress_report.png",class:"w-10 h-10",alt:""},null,-1),e("span",{class:"text-sm"},"Progress Reports",-1)]),2),e("div",{class:g(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",t.route().current("parent.invoices")?"font-extrabold":""]),onClick:s[2]||(s[2]=o=>t.$inertia.get(t.route("parent.invoices")))},s[8]||(s[8]=[e("img",{src:"/images/parents/fee_invoice.png",class:"w-10 h-10",alt:""},null,-1),e("span",{class:"text-sm"},"Invoices",-1)]),2),t.$page.props.current_active_programme.id==3||t.$page.props.current_active_programme.id==5?(r(),a("div",{key:0,class:g(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",t.route().current("parent.art_gallery")?"font-extrabold":""]),onClick:s[3]||(s[3]=o=>t.$inertia.get(t.route("parent.art_gallery")))},s[9]||(s[9]=[e("img",{src:"/images/parents/art_gallery.png",class:"w-10 h-10",alt:""},null,-1),e("span",{class:"text-sm"},"Art Gallery",-1)]),2)):n("",!0),t.$page.props.current_active_programme.id==3||t.$page.props.current_active_programme.id==5?(r(),a("div",{key:1,class:g(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",t.route().current("parent.art_book")?"font-extrabold":""]),onClick:s[4]||(s[4]=o=>t.$inertia.get(t.route("parent.art_book")))},s[10]||(s[10]=[e("img",{src:"/images/parents/art_book.png",class:"w-10 h-10",alt:""},null,-1),e("span",{class:"text-sm"},"Art Book",-1)]),2)):n("",!0)])]),_:1})]),e("div",A,[t.$page.props.stories.data.length?(r(),a("div",T,s[11]||(s[11]=[e("h2",{class:"text-lg md:text-xl mx-1 font-extrabold"},"Stories",-1)]))):n("",!0),t.$page.props.stories.data.length?n("",!0):(r(),a("div",V,s[12]||(s[12]=[e("span",{class:"text-slate-500"},"No Stories Found",-1)]))),t.$page.props.stories.data.length?(r(!0),a(h,{key:2},v(t.$page.props.stories.data,(o,p)=>(r(),a("div",j,[e("div",N,[e("div",P,[e("div",I,[e("span",E,u(o.story_author_name),1),e("span",Z,u(o.story_programme_name),1)]),e("div",F,[d(w,{class:"text-gray-500 font-medium text-xs",datetime:o.story_date},null,8,["datetime"])])])]),s[17]||(s[17]=e("hr",null,null,-1)),e("span",K,u(o.story_title),1),o.images?(r(),f(c(k),{key:0,mouseDrag:o.images.length>1,touchDrag:o.images.length>1},{addons:m(()=>[o.images.length>1?(r(),f(c(y),{key:0})):n("",!0)]),default:m(()=>[(r(!0),a(h,null,v(o.images,(l,ne)=>(r(),f(c(b),{key:l},{default:m(()=>[e("div",U,[e("img",{src:"/storage/stories/"+l.image_filename,class:"select-none h-full",onDblclick:pe=>t.toggleLike(p,o.story_id)},null,40,q)])]),_:2},1024))),128))]),_:2},1032,["mouseDrag","touchDrag"])):n("",!0),e("div",G,[t.$page.props.can.create_stories?n("",!0):(r(),a("div",J,[t.isLikedByParent(p)?(r(),a("svg",{key:0,onClick:l=>t.toggleLike(p,o.story_id),xmlns:"http://www.w3.org/2000/svg",class:"inline-block h-6 w-6 text-red-500 cursor-pointer",fill:"currentColor",viewBox:"0 0 512 512"},s[13]||(s[13]=[e("path",{d:"M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"},null,-1)]),8,O)):(r(),a("svg",{key:1,onClick:l=>t.toggleLike(p,o.story_id),xmlns:"http://www.w3.org/2000/svg",class:"inline-block h-6 w-6 text-gray-500 hover:text-red-500 cursor-pointer",fill:"currentColor",viewBox:"0 0 512 512"},s[14]||(s[14]=[e("path",{d:"M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"},null,-1)]),8,Q))])),e("div",{class:"",onClick:s[5]||(s[5]=l=>t.toggleComment())},s[15]||(s[15]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"inline-block h-6 w-6 text-gray-500 hover:text-red-500 cursor-pointer",fill:"currentColor",viewBox:"0 0 512 512"},[e("path",{d:"M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9c.1-.2 .2-.3 .3-.5z"})],-1)]))]),t.show_comment?(r(),a("div",R,[o.comments.length?(r(),a("div",W,[d(c(x),{"data-simplebar-auto-hide":"true",class:"max-h-96"},{default:m(()=>[e("div",X,[(r(!0),a(h,null,v(o.comments,l=>(r(),a("div",Y,[e("div",ee,[e("div",te,[_(u(l.comment_user_name)+" ",1),e("span",se,[(r(),f(w,{class:"text-gray-500 font-medium text-xs",datetime:l.created_at,key:l.created_at},null,8,["datetime"]))])]),e("div",oe,u(l.comment),1)])]))),256))])]),_:2},1024)])):n("",!0),$((r(),a("textarea",{class:"bg-white border border-gray-300 p-2 px-3.5 rounded-lg w-full resize-none focus:ring-0 focus:border-2 focus:border-indigo-300 text-sm",rows:"2",placeholder:"Drop a comment...",key:p,"onUpdate:modelValue":l=>t.comments[p]=l},null,8,re)),[[C,t.comments[p]]]),e("div",{class:"flex justify-end",onClick:l=>t.postComment(p,o.story_id)},s[16]||(s[16]=[e("button",{class:"px-4 py-2 text-xs bg-indigo-600 hover:bg-indigo-700 text-white rounded-md"},"Comment",-1)]),8,ae)])):n("",!0)]))),256)):n("",!0),t.loading.stories?(r(),a("div",ie,s[18]||(s[18]=[e("div",{class:"flex items-center"},[e("div",null,[e("div",{class:"h-2.5 bg-gray-200 rounded-full dark:bg-gray-700 w-32 mb-2"}),e("div",{class:"w-48 h-2 bg-gray-200 rounded-full dark:bg-gray-700 mb-4"})])],-1),e("hr",null,null,-1),e("div",{class:"h-2.5 bg-gray-200 rounded-full dark:bg-gray-700 w-48 mb-4 mt-3"},null,-1),e("div",{class:"flex items-center justify-center h-48 mb-4 bg-gray-300 rounded dark:bg-gray-700"},[e("svg",{class:"w-10 h-10 text-gray-200 dark:text-gray-600","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 20"},[e("path",{d:"M14.066 0H7v5a2 2 0 0 1-2 2H0v11a1.97 1.97 0 0 0 1.934 2h12.132A1.97 1.97 0 0 0 16 18V2a1.97 1.97 0 0 0-1.934-2ZM10.5 6a1.5 1.5 0 1 1 0 2.999A1.5 1.5 0 0 1 10.5 6Zm2.221 10.515a1 1 0 0 1-.858.485h-8a1 1 0 0 1-.9-1.43L5.6 10.039a.978.978 0 0 1 .936-.57 1 1 0 0 1 .9.632l1.181 2.981.541-1a.945.945 0 0 1 .883-.522 1 1 0 0 1 .879.529l1.832 3.438a1 1 0 0 1-.031.988Z"}),e("path",{d:"M5 5V.13a2.96 2.96 0 0 0-1.293.749L.879 3.707A2.98 2.98 0 0 0 .13 5H5Z"})])],-1),e("span",{class:"sr-only"},"Loading...",-1)]))):n("",!0)])]),_:1},8,["onScroll"])],64))}});export{mt as default};
